<!DOCTYPE HTML>

<html>
    <head>
        <script type="application/ld+json">
    {
        "@context" : "http://schema.org",
        "@type" : "BlogPosting",
        "mainEntityOfPage": {
             "@type": "WebPage",
             "@id": "\/"
        },
        "articleSection" : "blog",
        "name" : "MY FIRST EXPERIENCE WITH THE AZURE DURABLE FUNCTIONS",
        "headline" : "MY FIRST EXPERIENCE WITH THE AZURE DURABLE FUNCTIONS",
        "description" : "Introduction Of late, I got a requirement to start the Azure runbooks programmatically (start a runbook through another runbook), and as a PowerShell fan, I said, “Start-AzAutomationAccountRunBook” is one best way to achieve it. An hour later, I got a call to build a script that waits until the job completes and gets the output. Here is a quick way “-Wait” parameter. Solved the issue? Yes! Now, it’s time for us to deliver a REST API endpoint, which is required to invoke in an Azure Pipeline for the business process.",
        "inLanguage" : "en",
        "author" : "",
        "creator" : "",
        "publisher": "",
        "accountablePerson" : "",
        "copyrightHolder" : "",
        "copyrightYear" : "2020",
        "datePublished": "2020-06-28 00:00:00 \u002b0000 UTC",
        "dateModified" : "2020-06-28 00:00:00 \u002b0000 UTC",
        "url" : "\/blog\/my-first-experience-with-the-azure-durable-functions\/",
        "wordCount" : "551",
        "keywords" : [ "Azure Function","Durable","C#","Blog" ]
    }
    </script>
        
            
                <title>MY FIRST EXPERIENCE WITH THE AZURE DURABLE FUNCTIONS</title>
            
        

        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="generator" content="Hugo 0.74.2" />
        


        
            <meta name="author" content="Chendrayan Venkatesan">
        
        
            
                <meta name="description" content="HTML5 UP theme, Future Imperfect with some extra goodies, ported by Julio Pescador. Powered by Hugo">
            
        

        <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="MY FIRST EXPERIENCE WITH THE AZURE DURABLE FUNCTIONS"/>
<meta name="twitter:description" content="Introduction Of late, I got a requirement to start the Azure runbooks programmatically (start a runbook through another runbook), and as a PowerShell fan, I said, “Start-AzAutomationAccountRunBook” is one best way to achieve it. An hour later, I got a call to build a script that waits until the job completes and gets the output. Here is a quick way “-Wait” parameter. Solved the issue? Yes! Now, it’s time for us to deliver a REST API endpoint, which is required to invoke in an Azure Pipeline for the business process."/>
<meta name="twitter:site" content="@chendrayanv"/>

        <meta property="og:title" content="MY FIRST EXPERIENCE WITH THE AZURE DURABLE FUNCTIONS" />
<meta property="og:description" content="Introduction Of late, I got a requirement to start the Azure runbooks programmatically (start a runbook through another runbook), and as a PowerShell fan, I said, “Start-AzAutomationAccountRunBook” is one best way to achieve it. An hour later, I got a call to build a script that waits until the job completes and gets the output. Here is a quick way “-Wait” parameter. Solved the issue? Yes! Now, it’s time for us to deliver a REST API endpoint, which is required to invoke in an Azure Pipeline for the business process." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/blog/my-first-experience-with-the-azure-durable-functions/" />
<meta property="article:published_time" content="2020-06-28T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-06-28T00:00:00+00:00" />

        <meta property="og:image" content="//images/logo.png">
        <meta property="og:image:type" content="image/png">
        <meta property="og:image:width" content="512">
        <meta property="og:image:height" content="512">
        <meta itemprop="name" content="MY FIRST EXPERIENCE WITH THE AZURE DURABLE FUNCTIONS">
<meta itemprop="description" content="Introduction Of late, I got a requirement to start the Azure runbooks programmatically (start a runbook through another runbook), and as a PowerShell fan, I said, “Start-AzAutomationAccountRunBook” is one best way to achieve it. An hour later, I got a call to build a script that waits until the job completes and gets the output. Here is a quick way “-Wait” parameter. Solved the issue? Yes! Now, it’s time for us to deliver a REST API endpoint, which is required to invoke in an Azure Pipeline for the business process.">
<meta itemprop="datePublished" content="2020-06-28T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2020-06-28T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="551">



<meta itemprop="keywords" content="Azure Function,Durable,C#," />
        

        
            
        

        
        
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css">
            <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway:400,800,900|Source+Sans+Pro:400,700">
            <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.1.25/jquery.fancybox.min.css">
            <link rel="stylesheet" href="/css/main.css">
            <link rel="stylesheet" href="/css/add-on.css">
            <link rel="stylesheet" href="/css/academicons.min.css">
        

        
            
                
            
        


  
    
    <link href='//cdn.bootcss.com/highlight.js/9.11.0/styles/github.min.css' rel='stylesheet' type='text/css' />
  


      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-186894445-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

    </head>
    <body>

      
      <div id="wrapper">

    
    
<header id="header">
    
      <h1><a href="/">blog</a></h1>
    

    <nav class="links">
        <ul>
            
                <li>
                    <a href="/">
                            <i class="fa fa-home">&nbsp;</i>Home
                    </a>
                </li>
            
                <li>
                    <a href="/about/">
                            <i class="fa fa-id-card-o">&nbsp;</i>About
                    </a>
                </li>
            
                <li>
                    <a href="/blog/">
                            <i class="fa fa-newspaper-o">&nbsp;</i>Blog
                    </a>
                </li>
            
                <li>
                    <a href="/itemized/">
                            <i class="fa fa-list">&nbsp;</i>Itemized
                    </a>
                </li>
            
                <li>
                    <a href="/categories/">
                            <i class="fa fa-sitemap">&nbsp;</i>Categories
                    </a>
                </li>
            
                <li>
                    <a href="/contact/">
                            <i class="fa fa-envelope-o">&nbsp;</i>Contact
                    </a>
                </li>
            
        </ul>
    </nav>
    <nav class="main">
        <ul>
            
            <li id="share-nav" class="share-menu" style="display:none;">
                <a class="fa-share-alt" href="#share-menu">Share</a>
            </li>
            
            <li class="search">
                <a class="fa-search" href="#search">Search</a>
                <form id="search" method="get" action="//google.com/search">
                    <input type="text" name="q" placeholder="Search" />
                    <input type="hidden" name="as_sitesearch" value="/">
                </form>
            </li>
            <li class="menu">
                <a class="fa-bars" href="#menu">Menu</a>
            </li>
        </ul>
    </nav>
</header>


<section id="menu">

    
        <section>
            <form class="search" method="get" action="//google.com/search">
                <input type="text" name="q" placeholder="Search" />
                <input type="hidden" name="as_sitesearch" value="/">
            </form>
        </section>

    
        <section>
            <ul class="links">
                
                    <li>
                        <a href="/">
                            <h3>
                                <i class="fa fa-home">&nbsp;</i>Home
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="/about/">
                            <h3>
                                <i class="fa fa-id-card-o">&nbsp;</i>About
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="/blog/">
                            <h3>
                                <i class="fa fa-newspaper-o">&nbsp;</i>Blog
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="/itemized/">
                            <h3>
                                <i class="fa fa-list">&nbsp;</i>Itemized
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="/categories/">
                            <h3>
                                <i class="fa fa-sitemap">&nbsp;</i>Categories
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="/contact/">
                            <h3>
                                <i class="fa fa-envelope-o">&nbsp;</i>Contact
                            </h3>
                        </a>
                    </li>
                
            </ul>
        </section>

    
        <section class="recent-posts">
            <div class="mini-posts">
                <header>
                    <h3>Recent Posts</h3>
                </header>
                

                
                    
                

                
                        <article class="mini-post">
                            <header>
                                <h3><a href="/blog/deploy-azure-function-app-using-project-bicep/">Deploy Azure Function App using Project Bicep</a></h3>
                                
                                <time class="published" datetime=
                                    '2021-01-07'>
                                    January 7, 2021</time>
                            </header>
                            
    

    
        
        







  
  
    
  


        
        
        

        <a href="/blog/deploy-azure-function-app-using-project-bicep/" class="image featured">
            <img src="/img/2021/01/az-function-app.jpg" alt="">
        </a>
    


                        </article>
                
                        <article class="mini-post">
                            <header>
                                <h3><a href="/blog/list-of-azure-vm-which-has-no-jit-enabled/">Retrieve a list of Azure VM which aren&#39;t protected with just-in-time network access control</a></h3>
                                
                                <time class="published" datetime=
                                    '2021-01-04'>
                                    January 4, 2021</time>
                            </header>
                            
    

    
        
        







  
  
    
  


        
        
        

        <a href="/blog/list-of-azure-vm-which-has-no-jit-enabled/" class="image featured">
            <img src="/img/2021/01/security.jpg" alt="">
        </a>
    


                        </article>
                
                        <article class="mini-post">
                            <header>
                                <h3><a href="/blog/get-started-with-project-bicep/">Get started with project bicep</a></h3>
                                
                                <time class="published" datetime=
                                    '2021-01-03'>
                                    January 3, 2021</time>
                            </header>
                            
    

    
        
        







  
  
    
  


        
        
        

        <a href="/blog/get-started-with-project-bicep/" class="image featured">
            <img src="/img/2021/01/bicep-header.jpg" alt="">
        </a>
    


                        </article>
                
                        <article class="mini-post">
                            <header>
                                <h3><a href="/blog/logging-service-now-requests-using-event-grid-trigger/">Logging Service Now Requests using Event Grid Trigger</a></h3>
                                
                                <time class="published" datetime=
                                    '2020-08-01'>
                                    August 1, 2020</time>
                            </header>
                            
    

    
        
        







  
  
    
  


        
        
        

        <a href="/blog/logging-service-now-requests-using-event-grid-trigger/" class="image featured">
            <img src="/img/2020/08/Wheels.jpg" alt="">
        </a>
    


                        </article>
                
                        <article class="mini-post">
                            <header>
                                <h3><a href="/blog/azure-devops-pipeline-to-send-files-through-email-with-no-marketplace-extension/">azure devops pipeline to send files through email with no marketplace extension</a></h3>
                                
                                <time class="published" datetime=
                                    '2020-07-19'>
                                    July 19, 2020</time>
                            </header>
                            
    

    
        
        







  
  
    
  


        
        
        

        <a href="/blog/azure-devops-pipeline-to-send-files-through-email-with-no-marketplace-extension/" class="image featured">
            <img src="/img/2020/07/" alt="">
        </a>
    


                        </article>
                

                
                    <a href=
                        
                            /blog/
                        
                        class="button">View more posts</a>
                
            </div>
        </section>

    
        
</section>

    <section id="share-menu">
    <section id="social-share-nav">
        <ul class="links">
            <header>
                <h3>Share this post <i class="fa fa-smile-o"></i></h3>
            </header>
            



<li>
  <a href="//twitter.com/share?url=%2fblog%2fmy-first-experience-with-the-azure-durable-functions%2f&amp;text=MY%20FIRST%20EXPERIENCE%20WITH%20THE%20AZURE%20DURABLE%20FUNCTIONS&amp;via=chendrayanv" target="_blank" class="share-btn twitter">
    <i class="fa fa-twitter"></i>
    <p>Twitter</p>
    </a>
</li>




<li>
  <a href="//plus.google.com/share?url=%2fblog%2fmy-first-experience-with-the-azure-durable-functions%2f" target="_blank" class="share-btn google-plus">
    <i class="fa fa-google-plus"></i>
    <p>Google+</p>
  </a>
</li>





<li>
  <a href="//www.facebook.com/sharer/sharer.php?u=%2fblog%2fmy-first-experience-with-the-azure-durable-functions%2f" target="_blank" class="share-btn facebook">
    <i class="fa fa-facebook"></i>
    <p>Facebook</p>
    </a>
</li>




<li>
  <a href="//reddit.com/submit?url=%2fblog%2fmy-first-experience-with-the-azure-durable-functions%2f&amp;title=MY%20FIRST%20EXPERIENCE%20WITH%20THE%20AZURE%20DURABLE%20FUNCTIONS" target="_blank" class="share-btn reddit">
    <i class="fa fa-reddit-alien"></i>
    <p>Reddit</p>
  </a>
</li>




<li>
  <a href="//www.linkedin.com/shareArticle?url=%2fblog%2fmy-first-experience-with-the-azure-durable-functions%2f&amp;title=MY%20FIRST%20EXPERIENCE%20WITH%20THE%20AZURE%20DURABLE%20FUNCTIONS" target="_blank" class="share-btn linkedin">
      <i class="fa fa-linkedin"></i>
      <p>LinkedIn</p>
    </a>
</li>




<li>
  <a href="//www.stumbleupon.com/submit?url=%2fblog%2fmy-first-experience-with-the-azure-durable-functions%2f&amp;title=MY%20FIRST%20EXPERIENCE%20WITH%20THE%20AZURE%20DURABLE%20FUNCTIONS" target="_blank" class="share-btn stumbleupon">
    <i class="fa fa-stumbleupon"></i>
    <p>StumbleUpon</p>
  </a>
</li>




<li>
  <a href="//www.pinterest.com/pin/create/button/?url=%2fblog%2fmy-first-experience-with-the-azure-durable-functions%2f&amp;description=MY%20FIRST%20EXPERIENCE%20WITH%20THE%20AZURE%20DURABLE%20FUNCTIONS" target="_blank" class="share-btn pinterest">
    <i class="fa fa-pinterest-p"></i>
    <p>Pinterest</p>
  </a>
</li>




<li>
  <a href="mailto:?subject=Check out this post by Chendrayan%20Venkatesan&amp;body=%2fblog%2fmy-first-experience-with-the-azure-durable-functions%2f" target="_blank" class="share-btn email">
    <i class="fa fa-envelope"></i>
    <p>Email</p>
  </a>
</li>


        </ul>
    </section>
</section>

    
    <div id="main">
        
        
        <article class="post">
  <header>
    <div class="title">
        
            <h1><a href="/blog/my-first-experience-with-the-azure-durable-functions/">MY FIRST EXPERIENCE WITH THE AZURE DURABLE FUNCTIONS</a></h1>
            
        
        
    </div>
    <div class="meta">
        

        <time class="published"
            datetime='2020-06-28'>
            June 28, 2020</time>
        <span class="author">Chendrayan Venkatesan</span>
        
            <p>3 minute read</p>
        
        
    </div>
</header>


  
    <section id="social-share">
      <ul class="icons">
        



<li>
  <a href="//twitter.com/share?url=%2fblog%2fmy-first-experience-with-the-azure-durable-functions%2f&amp;text=MY%20FIRST%20EXPERIENCE%20WITH%20THE%20AZURE%20DURABLE%20FUNCTIONS&amp;via=chendrayanv" target="_blank" class="share-btn twitter">
    <i class="fa fa-twitter"></i>
    <p>Twitter</p>
    </a>
</li>




<li>
  <a href="//plus.google.com/share?url=%2fblog%2fmy-first-experience-with-the-azure-durable-functions%2f" target="_blank" class="share-btn google-plus">
    <i class="fa fa-google-plus"></i>
    <p>Google+</p>
  </a>
</li>





<li>
  <a href="//www.facebook.com/sharer/sharer.php?u=%2fblog%2fmy-first-experience-with-the-azure-durable-functions%2f" target="_blank" class="share-btn facebook">
    <i class="fa fa-facebook"></i>
    <p>Facebook</p>
    </a>
</li>




<li>
  <a href="//reddit.com/submit?url=%2fblog%2fmy-first-experience-with-the-azure-durable-functions%2f&amp;title=MY%20FIRST%20EXPERIENCE%20WITH%20THE%20AZURE%20DURABLE%20FUNCTIONS" target="_blank" class="share-btn reddit">
    <i class="fa fa-reddit-alien"></i>
    <p>Reddit</p>
  </a>
</li>




<li>
  <a href="//www.linkedin.com/shareArticle?url=%2fblog%2fmy-first-experience-with-the-azure-durable-functions%2f&amp;title=MY%20FIRST%20EXPERIENCE%20WITH%20THE%20AZURE%20DURABLE%20FUNCTIONS" target="_blank" class="share-btn linkedin">
      <i class="fa fa-linkedin"></i>
      <p>LinkedIn</p>
    </a>
</li>




<li>
  <a href="//www.stumbleupon.com/submit?url=%2fblog%2fmy-first-experience-with-the-azure-durable-functions%2f&amp;title=MY%20FIRST%20EXPERIENCE%20WITH%20THE%20AZURE%20DURABLE%20FUNCTIONS" target="_blank" class="share-btn stumbleupon">
    <i class="fa fa-stumbleupon"></i>
    <p>StumbleUpon</p>
  </a>
</li>




<li>
  <a href="//www.pinterest.com/pin/create/button/?url=%2fblog%2fmy-first-experience-with-the-azure-durable-functions%2f&amp;description=MY%20FIRST%20EXPERIENCE%20WITH%20THE%20AZURE%20DURABLE%20FUNCTIONS" target="_blank" class="share-btn pinterest">
    <i class="fa fa-pinterest-p"></i>
    <p>Pinterest</p>
  </a>
</li>




<li>
  <a href="mailto:?subject=Check out this post by Chendrayan%20Venkatesan&amp;body=%2fblog%2fmy-first-experience-with-the-azure-durable-functions%2f" target="_blank" class="share-btn email">
    <i class="fa fa-envelope"></i>
    <p>Email</p>
  </a>
</li>


      </ul>
    </section>
  

  
    

    
        
        







  
  
    
  


        
        
        

        <a href="/blog/my-first-experience-with-the-azure-durable-functions/" class="image featured">
            <img src="/img/2020/06/Sand-Clock.jpg" alt="">
        </a>
    


  <div id="content">
    <h2 id="introduction">Introduction</h2>
<p>Of late, I got a requirement to start the Azure runbooks programmatically (start a runbook through another runbook), and as a PowerShell fan, I said, “Start-AzAutomationAccountRunBook” is one best way to achieve it. An hour later, I got a call to build a script that waits until the job completes and gets the output. Here is a quick way “-Wait” parameter. Solved the issue? Yes! Now, it’s time for us to deliver a REST API endpoint, which is required to invoke in an Azure Pipeline for the business process.</p>
<p>As you guessed, I did that! I did a lift shift of the PowerShell script to Azure functions, and all worked fine as expected. One beautiful day the issue occurred “503 Time-Out Occurred”. First, I thought the issue is due to a cold and warm start. But that’s not the case here! The HTTP trigger is to call the parent runbook, which may run more than 230 seconds and times out. The maximum timeout of HTTP Trigger is 230 seconds (4 minutes), and this can’t be changed.</p>
<p>When the runbook job is submitted, it gets queued and then moves to “running,” waits until the job completes, and then returns the output.</p>
<blockquote>
<p>The below snippet does the same.</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-PowerShell" data-lang="PowerShell">$params = @{
    Name                  = <span style="color:#e6db74">&#34;iTrigger&#34;</span>
    ResourceGroupName     = <span style="color:#e6db74">&#34;iAutomate&#34;</span>
    AutomationAccountName = <span style="color:#e6db74">&#34;iautomate-AAA&#34;</span>
    Parameters            = @{FirstName = <span style="color:#e6db74">&#39;Chen&#39;</span>; SurName = <span style="color:#e6db74">&#39;V&#39;</span>; Skills = @(<span style="color:#e6db74">&#39;C#&#39;</span> , <span style="color:#e6db74">&#39;PowerShell&#39;</span>) }
    Wait                  = $true 
}
Start-AzAutomationRunbook @params
</code></pre></div><h2 id="azure-durbale-functions">Azure Durbale Functions</h2>
<blockquote>
<p>If you are new to Azure Durable Functions, please refer to this <a href="https://docs.microsoft.com/en-us/azure/azure-functions/durable/durable-functions-overview?tabs=csharp">document</a> to get to know more information.</p>
</blockquote>
<p>An overview of my requirement is depicted below</p>
<p><img src="img/2020/06/async-http-api.png" alt="image"></p>
<h3 id="http-starter-function">HTTP Starter Function</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C#" data-lang="C#"><span style="color:#a6e22e">[FunctionName(&#34;FunctionName_HTTPStart&#34;)]</span>
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">async</span> Task&lt;HttpResponseMessage&gt; HttpStart(
<span style="color:#a6e22e">            [HttpTrigger(AuthorizationLevel.Anonymous, &#34;get&#34;, &#34;post&#34;)]</span> HttpRequestMessage req,
<span style="color:#a6e22e">            [DurableClient]</span> IDurableOrchestrationClient starter,
            ILogger log)
        {
            <span style="color:#66d9ef">var</span> groupRequest = <span style="color:#66d9ef">await</span> req.Content.ReadAsAsync&lt;iRunBook&gt;();
            <span style="color:#66d9ef">string</span> instanceId = <span style="color:#66d9ef">await</span> starter.StartNewAsync(<span style="color:#e6db74">&#34;FunctionName&#34;</span>, groupRequest);
            log.LogInformation(<span style="color:#e6db74">$&#34;Started orchestration with ID = &#39;{instanceId}&#39;.&#34;</span>);
            <span style="color:#66d9ef">return</span> starter.CreateCheckStatusResponse(req, instanceId);
        }
</code></pre></div><h3 id="http-durable-function">HTTP Durable Function</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C#" data-lang="C#"><span style="color:#66d9ef">do</span>
{
    result = automationManagementClient.Jobs.Get(Environment.GetEnvironmentVariable(<span style="color:#e6db74">&#34;RESOURCE_GROUP&#34;</span>), Environment.GetEnvironmentVariable(<span style="color:#e6db74">&#34;AUTOMATION_ACCOUNT_NAME&#34;</span>), jobCreateResponse.Job.Properties.JobId);
    System.Threading.Thread.Sleep(<span style="color:#ae81ff">30000</span>);
} <span style="color:#66d9ef">while</span> ((result.Job.Properties.Status != JobStatus.Completed) &amp;&amp; (result.Job.Properties.Status != JobStatus.Failed) &amp;&amp; ((result.Job.Properties.Status != JobStatus.Stopped) &amp;&amp; ((result.Job.Properties.Status != JobStatus.Suspended))));
System.Threading.Thread.Sleep(<span style="color:#ae81ff">30000</span>);
JobGetOutputResponse jobGetOutputResponse = automationManagementClient.Jobs.GetOutput(Environment.GetEnvironmentVariable(<span style="color:#e6db74">&#34;RESOURCE_GROUP&#34;</span>), Environment.GetEnvironmentVariable(<span style="color:#e6db74">&#34;AUTOMATION_ACCOUNT_NAME&#34;</span>), jobCreateResponse.Job.Properties.JobId);
<span style="color:#66d9ef">return</span> jobGetOutputResponse.Output;
</code></pre></div><h3 id="irunbook-model">iRunBook Model</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C#" data-lang="C#"><span style="color:#66d9ef">using</span> System;

<span style="color:#66d9ef">namespace</span> iRunBook
{
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> FirstName {<span style="color:#66d9ef">get</span>;<span style="color:#66d9ef">set</span>;}
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> SurName {<span style="color:#66d9ef">get</span>;<span style="color:#66d9ef">set</span>;}
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> Skills {<span style="color:#66d9ef">get</span>;<span style="color:#66d9ef">set</span>;}
}
</code></pre></div><h3 id="challenge">Challenge</h3>
<p>The runbook we need to start has three parameters like listed below</p>
<ol>
<li>FirstName (String)</li>
<li>SurName (String)</li>
<li>Skills (Array)</li>
</ol>
<blockquote>
<p>The <code>JobCreateParameters</code> has parameters properties which is of type <strong>IDictionary&lt;String, String&gt;</strong></p>
</blockquote>
<p>So, the client code to invoke the parameters needs a minor modification as shown below</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-PowerShell" data-lang="PowerShell">$body = <span style="color:#66d9ef">[pscustomobject]</span>@{
    FirstName = <span style="color:#e6db74">&#34;Chendrayan&#34;</span>
    SurName   = <span style="color:#e6db74">&#34;Venkatesan&#34;</span>
    Skills    = <span style="color:#e6db74">&#39;[&#34;C#&#34; , &#34;PowerShell&#34; , &#34;Webframework&#34;]&#39;</span>
} | ConvertTo-Json 
<span style="color:#66d9ef">[Net.ServicePointManager]</span>::SecurityProtocol = <span style="color:#66d9ef">[Net.SecurityProtocolType]</span>::Tls <span style="color:#f92672">-bor</span> <span style="color:#66d9ef">[Net.SecurityProtocolType]</span>::Tls11 <span style="color:#f92672">-bor</span> <span style="color:#66d9ef">[Net.SecurityProtocolType]</span>::Tls12
 
$Params = @{
    Uri         = <span style="color:#e6db74">&#34;https://iSite.azurewebsites.net/api/FunctionName_HttpStart&#34;</span>
    Method      = <span style="color:#e6db74">&#34;POST&#34;</span>
    Body        = $body
    ContentType = <span style="color:#e6db74">&#34;application/json&#34;</span>
    Verbose     = $true
}
$invokeResponse = Invoke-RestMethod @Params
Start-Sleep -Seconds 5
<span style="color:#66d9ef">do</span> {
    Start-Sleep -Seconds 5
    $status = Invoke-RestMethod $invokeResponse.statusQueryGetUri -Verbose
    $status
} <span style="color:#66d9ef">until</span> ($status.runtimeStatus <span style="color:#f92672">-eq</span> <span style="color:#e6db74">&#39;Completed&#39;</span> <span style="color:#f92672">-or</span> $status.runtimeStatus <span style="color:#f92672">-eq</span> <span style="color:#e6db74">&#39;Failed&#39;</span>)
</code></pre></div><h2 id="conclusion">Conclusion</h2>
<p>A simple conversion of my PowerShell script to C# helped me to solve the issue. In the HTTP durable function, we used <code>do while</code> loop to monitor the status and fetch the output. Yes, we can use the ASYNC programming pattern, which I am working on to share in my upcoming blog posts with another real-world example. Please share your valuable feedback. Follow me on <a href="https://twitter.com/chendrayanv">twitter</a>.</p>

  </div>

  <footer>
    <ul class="stats">
  <li class="categories">
    <ul>
        
            
            
                <i class="fa fa-folder"></i>
                
                
                <li><a class="article-category-link" href="/categories/azure">Azure</a></li>
                
            
        
    </ul>
  </li>
  <li class="tags">
    <ul>
        
            
            
                <i class="fa fa-tags"></i>
                
                
                <li><a class="article-category-link" href="/tags/azure-function">Azure Function</a></li>
                
                
                <li><a class="article-category-link" href="/tags/durable">Durable</a></li>
                
                
                <li><a class="article-category-link" href="/tags/c">C#</a></li>
                
            
        
    </ul>
  </li>
</ul>

  </footer>

</article>

    <article class="post">
        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "shortname" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </article>


<ul class="actions pagination">
    
        <li><a href="/blog/retrieve-unattached-azure-vm-disks-using-powershell-azure-resource-graph/"
                class="button big previous">Retrieve unattached Azure VM disks using PowerShell &amp; Azure Resource Graph</a></li>
    

    
        <li><a href="/blog/azure-devops-pipeline-to-send-files-through-email-with-no-marketplace-extension/"
                class="button big next">azure devops pipeline to send files through email with no marketplace extension</a></li>
    
</ul>


    </div>
    
<section id="sidebar">

  
  <section id="intro">
    
    
      
        <a href='/'><img src="/img/main/ChenV.jpg" class="intro-circle" width="200" alt="Hugo Future Imperfect" /></a>
      
    
    
      <header>
        <h2>Chendrayan Venkatesan</h2>
        <p>Views are of my own</p>
      </header>
    
    
      <ul class="icons">
        
          
    <li><a href="/index.xml" type="application/rss+xml" target="_blank" title="RSS" class="fa fa-rss"></a></li>


        
        
  <li><a href="//github.com/chendrayanv" target="_blank" title="GitHub" class="fa fa-github"></a></li>

























  <li><a href="//linkedin.com/in/chendrayanv" target="_blank" title="LinkedIn" class="fa fa-linkedin"></a></li>







  <li><a href="//xing.com/profile/Chendrayan_Venkatesan" target="_blank" title="Xing" class="fa fa-xing"></a></li>





  <li><a href="//facebook.com/chendrayanv" target="_blank" title="Facebook" class="fa fa-facebook"></a></li>









  <li><a href="//youtube.com/https://www.youtube.com/channel/UC22S6qPibfs1xa3MIII0JNw" target="_blank" title="YouTube" class="fa fa-youtube"></a></li>





  <li><a href="//api.whatsapp.com/send?phone=%2b91%2096201%2078698" target="_blank" title="WhatsApp" class="fa fa-whatsapp"></a></li>













  <li><a href="//twitter.com/chendrayanv" target="_blank" title="Twitter" class="fa fa-twitter"></a></li>



  <li><a href="skype:chendrayan.venkatesan?userinfo" target="_blank" title="Skype" class="fa fa-skype"></a></li>







  <li><a href="//telegram.me/&#43;91%2096201%2078698" target="_blank" title="telegram" class="fa fa-telegram"></a></li>











  <li><a href="mailto:chendrayan.exchange@hotmail.com" title="Email" class="fa fa-envelope"></a></li>


      </ul>
    
  </section>

  
  <section class="recent-posts">
    <div class="mini-posts">
      <header>
        <h3>Recent Posts</h3>
      </header>
      <div class="posts-container">
        

        
          
        

        
          <article class="mini-post">
            <header>
              <h3>
                <a href="/blog/deploy-azure-function-app-using-project-bicep/">Deploy Azure Function App using Project Bicep</a>
              </h3>
              
              <time class="published" datetime='2021-01-07'>
                January 7, 2021
              </time>
            </header>
            
    

    
        
        







  
  
    
  


        
        
        

        <a href="/blog/deploy-azure-function-app-using-project-bicep/" class="image featured">
            <img src="/img/2021/01/az-function-app.jpg" alt="">
        </a>
    


          </article>
        
          <article class="mini-post">
            <header>
              <h3>
                <a href="/blog/list-of-azure-vm-which-has-no-jit-enabled/">Retrieve a list of Azure VM which aren&#39;t protected with just-in-time network access control</a>
              </h3>
              
              <time class="published" datetime='2021-01-04'>
                January 4, 2021
              </time>
            </header>
            
    

    
        
        







  
  
    
  


        
        
        

        <a href="/blog/list-of-azure-vm-which-has-no-jit-enabled/" class="image featured">
            <img src="/img/2021/01/security.jpg" alt="">
        </a>
    


          </article>
        
          <article class="mini-post">
            <header>
              <h3>
                <a href="/blog/get-started-with-project-bicep/">Get started with project bicep</a>
              </h3>
              
              <time class="published" datetime='2021-01-03'>
                January 3, 2021
              </time>
            </header>
            
    

    
        
        







  
  
    
  


        
        
        

        <a href="/blog/get-started-with-project-bicep/" class="image featured">
            <img src="/img/2021/01/bicep-header.jpg" alt="">
        </a>
    


          </article>
        
          <article class="mini-post">
            <header>
              <h3>
                <a href="/blog/logging-service-now-requests-using-event-grid-trigger/">Logging Service Now Requests using Event Grid Trigger</a>
              </h3>
              
              <time class="published" datetime='2020-08-01'>
                August 1, 2020
              </time>
            </header>
            
    

    
        
        







  
  
    
  


        
        
        

        <a href="/blog/logging-service-now-requests-using-event-grid-trigger/" class="image featured">
            <img src="/img/2020/08/Wheels.jpg" alt="">
        </a>
    


          </article>
        
          <article class="mini-post">
            <header>
              <h3>
                <a href="/blog/azure-devops-pipeline-to-send-files-through-email-with-no-marketplace-extension/">azure devops pipeline to send files through email with no marketplace extension</a>
              </h3>
              
              <time class="published" datetime='2020-07-19'>
                July 19, 2020
              </time>
            </header>
            
    

    
        
        







  
  
    
  


        
        
        

        <a href="/blog/azure-devops-pipeline-to-send-files-through-email-with-no-marketplace-extension/" class="image featured">
            <img src="/img/2020/07/" alt="">
        </a>
    


          </article>
        
      </div>

      
        <a href=
          
            /blog/
          
        class="button">View more posts</a>
      
    </div>
  </section>

  
  
  
  
  
    <section id="categories">
      <header>
        <h3>
          <a href="/categories/">Categories</a>
        </h3>
      </header>
        
          
        

        
        <p>
          <article>
            <header>
              
                <a href="/categories/azure/">azure</a>
                <span style="float:right;">8</span>
              
            </header>
          </article>
        </p>
        
        <p>
          <article>
            <header>
              
                <a href="/categories/azure-devops/">azure-devops</a>
                <span style="float:right;">3</span>
              
            </header>
          </article>
        </p>
        
        <p>
          <article>
            <header>
              
                <a href="/categories/arm/">arm</a>
                <span style="float:right;">1</span>
              
            </header>
          </article>
        </p>
        
        <p>
          <article>
            <header>
              
                <a href="/categories/azure-functions/">azure-functions</a>
                <span style="float:right;">1</span>
              
            </header>
          </article>
        </p>
        
        <p>
          <article>
            <header>
              
                <a href="/categories/jit/">jit</a>
                <span style="float:right;">1</span>
              
            </header>
          </article>
        </p>
        
        <p>
          <article>
            <header>
              
                <a href="/categories/powershell/">powershell</a>
                <span style="float:right;">1</span>
              
            </header>
          </article>
        </p>
        
        <p>
          <article>
            <header>
              
                <a href="/categories/project-bicep/">project-bicep</a>
                <span style="float:right;">1</span>
              
            </header>
          </article>
        </p>
        
        <p>
          <article>
            <header>
              
                <a href="/categories/pswriteword/">pswriteword</a>
                <span style="float:right;">1</span>
              
            </header>
          </article>
        </p>
        
    </section>
  
  

  
  
    <section id="mini-bio">
      <h3>About</h3>
      <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent tellus lacus, auctor vehicula molestie quis, tempor quis velit. Quisque in quam ac leo efficitur vulputate. Phasellus ullamcorper aliquam sodales. Maecenas sit amet condimentum ipsum. Proin sit amet ligula elit. Mauris.</p>
      <a href="/about/" class="button">Learn More</a>
    </section>
  

  
  <section id="footer">
    
      <ul class="icons">
        
          
    <li><a href="/index.xml" type="application/rss+xml" target="_blank" title="RSS" class="fa fa-rss"></a></li>


        
        
  <li><a href="//github.com/chendrayanv" target="_blank" title="GitHub" class="fa fa-github"></a></li>

























  <li><a href="//linkedin.com/in/chendrayanv" target="_blank" title="LinkedIn" class="fa fa-linkedin"></a></li>







  <li><a href="//xing.com/profile/Chendrayan_Venkatesan" target="_blank" title="Xing" class="fa fa-xing"></a></li>





  <li><a href="//facebook.com/chendrayanv" target="_blank" title="Facebook" class="fa fa-facebook"></a></li>









  <li><a href="//youtube.com/https://www.youtube.com/channel/UC22S6qPibfs1xa3MIII0JNw" target="_blank" title="YouTube" class="fa fa-youtube"></a></li>





  <li><a href="//api.whatsapp.com/send?phone=%2b91%2096201%2078698" target="_blank" title="WhatsApp" class="fa fa-whatsapp"></a></li>













  <li><a href="//twitter.com/chendrayanv" target="_blank" title="Twitter" class="fa fa-twitter"></a></li>



  <li><a href="skype:chendrayan.venkatesan?userinfo" target="_blank" title="Skype" class="fa fa-skype"></a></li>







  <li><a href="//telegram.me/&#43;91%2096201%2078698" target="_blank" title="telegram" class="fa fa-telegram"></a></li>











  <li><a href="mailto:chendrayan.exchange@hotmail.com" title="Email" class="fa fa-envelope"></a></li>


      </ul>
    
    <p class="copyright">
      
        &copy; 2021
        
          iAutomate
        
      .
      Powered by <a href="//gohugo.io" target="_blank">Hugo</a>
    </p>
  </section>
</section>

    </div>
    <a id="back-to-top" href="#" class="fa fa-arrow-up fa-border fa-2x"></a>
    

    
      
    

    
      
      
      
        <script src="//cdn.bootcss.com/highlight.js/9.11.0/highlight.min.js"></script>
        
        
        
        <script src="//cdn.bootcss.com/highlight.js/9.11.0/languages/r.min.js"></script>
        <script src="//cdn.bootcss.com/highlight.js/9.11.0/languages/yaml.min.js"></script>
        <script src="//cdn.bootcss.com/highlight.js/9.11.0/languages/css.min.js"></script>
        <script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>
      
    
    
    
      <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/skel/3.0.1/skel.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.1.25/jquery.fancybox.min.js"></script>
      <script src="/js/util.js"></script>
      <script src="/js/main.js"></script>
      <script src="/js/backToTop.js"></script>
    

    
      
        
      
    

    
    <script>hljs.initHighlightingOnLoad();</script>
      <script src="//yihui.name/js/math-code.js"></script>
<script async
src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
</script>


  </body>
</html>

