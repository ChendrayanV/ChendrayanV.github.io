<!DOCTYPE HTML>

<html>
    <head>
        <script type="application/ld+json">
    {
        "@context" : "http://schema.org",
        "@type" : "BlogPosting",
        "mainEntityOfPage": {
             "@type": "WebPage",
             "@id": "\/"
        },
        "articleSection" : "blog",
        "name" : "Retrieve Azure Runbook Job Report using REST API with PowerShell",
        "headline" : "Retrieve Azure Runbook Job Report using REST API with PowerShell",
        "description" : "Fun at work!",
        "inLanguage" : "en",
        "author" : "",
        "creator" : "",
        "publisher": "",
        "accountablePerson" : "",
        "copyrightHolder" : "",
        "copyrightYear" : "2021",
        "datePublished": "2021-02-16 00:00:00 \u002b0000 UTC",
        "dateModified" : "2021-02-16 00:00:00 \u002b0000 UTC",
        "url" : "\/blog\/retrieve-azure-runbook-job-report-using-rest-api-with-powershell\/",
        "wordCount" : "477",
        "keywords" : [ "Resource Graph","PowerShell","REST API","Blog" ]
    }
    </script>
        
            
                <title>Retrieve Azure Runbook Job Report using REST API with PowerShell</title>
            
        

        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="generator" content="Hugo 0.82.0" />
        


        
            <meta name="author" content="Chendrayan Venkatesan">
        
        
            <meta name="description" content="Fun at work!">
        

        <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Retrieve Azure Runbook Job Report using REST API with PowerShell"/>
<meta name="twitter:description" content="Fun at work!"/>
<meta name="twitter:site" content="@chendrayanv"/>

        <meta property="og:title" content="Retrieve Azure Runbook Job Report using REST API with PowerShell" />
<meta property="og:description" content="Fun at work!" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/blog/retrieve-azure-runbook-job-report-using-rest-api-with-powershell/" /><meta property="article:section" content="blog" />
<meta property="article:published_time" content="2021-02-16T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2021-02-22T11:18:37&#43;05:30" />


        <meta property="og:image" content="//images/logo.png">
        <meta property="og:image:type" content="image/png">
        <meta property="og:image:width" content="512">
        <meta property="og:image:height" content="512">
        <meta itemprop="name" content="Retrieve Azure Runbook Job Report using REST API with PowerShell">
<meta itemprop="description" content="Fun at work!"><meta itemprop="datePublished" content="2021-02-16T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2021-02-22T11:18:37&#43;05:30" />
<meta itemprop="wordCount" content="477">
<meta itemprop="keywords" content="Resource Graph,PowerShell,REST API," />
        

        
            
        

        
        
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css">
            <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway:400,800,900|Source+Sans+Pro:400,700">
            <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.1.25/jquery.fancybox.min.css">
            <link rel="stylesheet" href="/css/main.css">
            <link rel="stylesheet" href="/css/add-on.css">
            <link rel="stylesheet" href="/css/academicons.min.css">
        

        
            
                
            
        


  
    
    <link href='//cdn.bootcss.com/highlight.js/9.11.0/styles/github.min.css' rel='stylesheet' type='text/css' />
  


      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-186894445-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
    </head>
    <body>

      
      <div id="wrapper">

    
    
<header id="header">
    
      <h1><a href="/">blog</a></h1>
    

    <nav class="links">
        <ul>
            
                <li>
                    <a href="/">
                            <i class="fa fa-home">&nbsp;</i>Home
                    </a>
                </li>
            
                <li>
                    <a href="/about/">
                            <i class="fa fa-id-card-o">&nbsp;</i>About
                    </a>
                </li>
            
                <li>
                    <a href="/blog/">
                            <i class="fa fa-newspaper-o">&nbsp;</i>Blog
                    </a>
                </li>
            
                <li>
                    <a href="/itemized/">
                            <i class="fa fa-list">&nbsp;</i>Itemized
                    </a>
                </li>
            
                <li>
                    <a href="/categories/">
                            <i class="fa fa-sitemap">&nbsp;</i>Categories
                    </a>
                </li>
            
                <li>
                    <a href="/contact/">
                            <i class="fa fa-envelope-o">&nbsp;</i>Contact
                    </a>
                </li>
            
        </ul>
    </nav>
    <nav class="main">
        <ul>
            
            <li id="share-nav" class="share-menu" style="display:none;">
                <a class="fa-share-alt" href="#share-menu">Share</a>
            </li>
            
            <li class="search">
                <a class="fa-search" href="#search">Search</a>
                <form id="search" method="get" action="//google.com/search">
                    <input type="text" name="q" placeholder="Search" />
                    <input type="hidden" name="as_sitesearch" value="/">
                </form>
            </li>
            <li class="menu">
                <a class="fa-bars" href="#menu">Menu</a>
            </li>
        </ul>
    </nav>
</header>


<section id="menu">

    
        <section>
            <form class="search" method="get" action="//google.com/search">
                <input type="text" name="q" placeholder="Search" />
                <input type="hidden" name="as_sitesearch" value="/">
            </form>
        </section>

    
        <section>
            <ul class="links">
                
                    <li>
                        <a href="/">
                            <h3>
                                <i class="fa fa-home">&nbsp;</i>Home
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="/about/">
                            <h3>
                                <i class="fa fa-id-card-o">&nbsp;</i>About
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="/blog/">
                            <h3>
                                <i class="fa fa-newspaper-o">&nbsp;</i>Blog
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="/itemized/">
                            <h3>
                                <i class="fa fa-list">&nbsp;</i>Itemized
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="/categories/">
                            <h3>
                                <i class="fa fa-sitemap">&nbsp;</i>Categories
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="/contact/">
                            <h3>
                                <i class="fa fa-envelope-o">&nbsp;</i>Contact
                            </h3>
                        </a>
                    </li>
                
            </ul>
        </section>

    
        <section class="recent-posts">
            <div class="mini-posts">
                <header>
                    <h3>Recent Posts</h3>
                </header>
                

                
                    
                

                
                        <article class="mini-post">
                            <header>
                                <h3><a href="/blog/azure-event-grid-trigger-output-binding-to-table-storage-using-powershell/">Azure Event Grid Trigger Output Binding to Table Storage using PowerShell</a></h3>
                                
                                <time class="published" datetime=
                                    '2021-04-08'>
                                    April 8, 2021</time>
                            </header>
                            
    

    
        
        







  
  
    
  


        
        
        

        <a href="/blog/azure-event-grid-trigger-output-binding-to-table-storage-using-powershell/" class="image featured">
            <img src="/img/2021/04/Table-Storage.jpg" alt="">
        </a>
    


                        </article>
                
                        <article class="mini-post">
                            <header>
                                <h3><a href="/blog/azure-functions-real-world-example-using-event-grid-trigger-with-powershell/">Azure Functions – Real-world example using Event Grid Trigger with PowerShell</a></h3>
                                
                                <time class="published" datetime=
                                    '2021-04-03'>
                                    April 3, 2021</time>
                            </header>
                            
    

    
        
        







  
  
    
  


        
        
        

        <a href="/blog/azure-functions-real-world-example-using-event-grid-trigger-with-powershell/" class="image featured">
            <img src="/img/2021/04/Blog-Az-Event-Grid.jpg" alt="">
        </a>
    


                        </article>
                
                        <article class="mini-post">
                            <header>
                                <h3><a href="/blog/using-pfx-in-azure-devops-to-generate-an-access-token-and-authenticate-powershell/">Using PFX in Azure DevOps to generate an access token and authenticate - PowerShell</a></h3>
                                
                                <time class="published" datetime=
                                    '2021-03-18'>
                                    March 18, 2021</time>
                            </header>
                            
    

    
        
        







  
  
    
  


        
        
        

        <a href="/blog/using-pfx-in-azure-devops-to-generate-an-access-token-and-authenticate-powershell/" class="image featured">
            <img src="/img/2021/03/access_token_pfx_cert.jpg" alt="">
        </a>
    


                        </article>
                
                        <article class="mini-post">
                            <header>
                                <h3><a href="/blog/retrieve-azure-runbook-job-report-using-rest-api-with-powershell/">Retrieve Azure Runbook Job Report using REST API with PowerShell</a></h3>
                                
                                <time class="published" datetime=
                                    '2021-02-16'>
                                    February 16, 2021</time>
                            </header>
                            
    

    
        
        







  
  
    
  


        
        
        

        <a href="/blog/retrieve-azure-runbook-job-report-using-rest-api-with-powershell/" class="image featured">
            <img src="/img/2021/02/Feb-16-Report.jpg" alt="">
        </a>
    


                        </article>
                
                        <article class="mini-post">
                            <header>
                                <h3><a href="/blog/collection-of-azure-resource-graph-query/">Collection of Azure Resource Graph Query</a></h3>
                                
                                <time class="published" datetime=
                                    '2021-02-07'>
                                    February 7, 2021</time>
                            </header>
                            
    

    
        
        







  
  
    
  


        
        
        

        <a href="/blog/collection-of-azure-resource-graph-query/" class="image featured">
            <img src="/img/2021/02/ARG-PS-Collection.jpg" alt="">
        </a>
    


                        </article>
                

                
                    <a href=
                        
                            /blog/
                        
                        class="button">View more posts</a>
                
            </div>
        </section>

    
        
</section>

    <section id="share-menu">
    <section id="social-share-nav">
        <ul class="links">
            <header>
                <h3>Share this post <i class="fa fa-smile-o"></i></h3>
            </header>
            



<li>
  <a href="//twitter.com/share?url=%2fblog%2fretrieve-azure-runbook-job-report-using-rest-api-with-powershell%2f&amp;text=Retrieve%20Azure%20Runbook%20Job%20Report%20using%20REST%20API%20with%20PowerShell&amp;via=chendrayanv" target="_blank" class="share-btn twitter">
    <i class="fa fa-twitter"></i>
    <p>Twitter</p>
    </a>
</li>




<li>
  <a href="//plus.google.com/share?url=%2fblog%2fretrieve-azure-runbook-job-report-using-rest-api-with-powershell%2f" target="_blank" class="share-btn google-plus">
    <i class="fa fa-google-plus"></i>
    <p>Google+</p>
  </a>
</li>





<li>
  <a href="//www.facebook.com/sharer/sharer.php?u=%2fblog%2fretrieve-azure-runbook-job-report-using-rest-api-with-powershell%2f" target="_blank" class="share-btn facebook">
    <i class="fa fa-facebook"></i>
    <p>Facebook</p>
    </a>
</li>




<li>
  <a href="//reddit.com/submit?url=%2fblog%2fretrieve-azure-runbook-job-report-using-rest-api-with-powershell%2f&amp;title=Retrieve%20Azure%20Runbook%20Job%20Report%20using%20REST%20API%20with%20PowerShell" target="_blank" class="share-btn reddit">
    <i class="fa fa-reddit-alien"></i>
    <p>Reddit</p>
  </a>
</li>




<li>
  <a href="//www.linkedin.com/shareArticle?url=%2fblog%2fretrieve-azure-runbook-job-report-using-rest-api-with-powershell%2f&amp;title=Retrieve%20Azure%20Runbook%20Job%20Report%20using%20REST%20API%20with%20PowerShell" target="_blank" class="share-btn linkedin">
      <i class="fa fa-linkedin"></i>
      <p>LinkedIn</p>
    </a>
</li>




<li>
  <a href="//www.stumbleupon.com/submit?url=%2fblog%2fretrieve-azure-runbook-job-report-using-rest-api-with-powershell%2f&amp;title=Retrieve%20Azure%20Runbook%20Job%20Report%20using%20REST%20API%20with%20PowerShell" target="_blank" class="share-btn stumbleupon">
    <i class="fa fa-stumbleupon"></i>
    <p>StumbleUpon</p>
  </a>
</li>




<li>
  <a href="//www.pinterest.com/pin/create/button/?url=%2fblog%2fretrieve-azure-runbook-job-report-using-rest-api-with-powershell%2f&amp;description=Retrieve%20Azure%20Runbook%20Job%20Report%20using%20REST%20API%20with%20PowerShell" target="_blank" class="share-btn pinterest">
    <i class="fa fa-pinterest-p"></i>
    <p>Pinterest</p>
  </a>
</li>




<li>
  <a href="mailto:?subject=Check out this post by Chendrayan%20Venkatesan&amp;body=%2fblog%2fretrieve-azure-runbook-job-report-using-rest-api-with-powershell%2f" target="_blank" class="share-btn email">
    <i class="fa fa-envelope"></i>
    <p>Email</p>
  </a>
</li>


        </ul>
    </section>
</section>

    
    <div id="main">
        
        
        <article class="post">
  <header>
    <div class="title">
        
            <h1><a href="/blog/retrieve-azure-runbook-job-report-using-rest-api-with-powershell/">Retrieve Azure Runbook Job Report using REST API with PowerShell</a></h1>
            
        
        
            <p>Fun at work!</p>
        
    </div>
    <div class="meta">
        

        <time class="published"
            datetime='2021-02-16'>
            February 16, 2021</time>
        <span class="author">Chendrayan Venkatesan</span>
        
            <p>3 minute read</p>
        
        
    </div>
</header>


  
    <section id="social-share">
      <ul class="icons">
        



<li>
  <a href="//twitter.com/share?url=%2fblog%2fretrieve-azure-runbook-job-report-using-rest-api-with-powershell%2f&amp;text=Retrieve%20Azure%20Runbook%20Job%20Report%20using%20REST%20API%20with%20PowerShell&amp;via=chendrayanv" target="_blank" class="share-btn twitter">
    <i class="fa fa-twitter"></i>
    <p>Twitter</p>
    </a>
</li>




<li>
  <a href="//plus.google.com/share?url=%2fblog%2fretrieve-azure-runbook-job-report-using-rest-api-with-powershell%2f" target="_blank" class="share-btn google-plus">
    <i class="fa fa-google-plus"></i>
    <p>Google+</p>
  </a>
</li>





<li>
  <a href="//www.facebook.com/sharer/sharer.php?u=%2fblog%2fretrieve-azure-runbook-job-report-using-rest-api-with-powershell%2f" target="_blank" class="share-btn facebook">
    <i class="fa fa-facebook"></i>
    <p>Facebook</p>
    </a>
</li>




<li>
  <a href="//reddit.com/submit?url=%2fblog%2fretrieve-azure-runbook-job-report-using-rest-api-with-powershell%2f&amp;title=Retrieve%20Azure%20Runbook%20Job%20Report%20using%20REST%20API%20with%20PowerShell" target="_blank" class="share-btn reddit">
    <i class="fa fa-reddit-alien"></i>
    <p>Reddit</p>
  </a>
</li>




<li>
  <a href="//www.linkedin.com/shareArticle?url=%2fblog%2fretrieve-azure-runbook-job-report-using-rest-api-with-powershell%2f&amp;title=Retrieve%20Azure%20Runbook%20Job%20Report%20using%20REST%20API%20with%20PowerShell" target="_blank" class="share-btn linkedin">
      <i class="fa fa-linkedin"></i>
      <p>LinkedIn</p>
    </a>
</li>




<li>
  <a href="//www.stumbleupon.com/submit?url=%2fblog%2fretrieve-azure-runbook-job-report-using-rest-api-with-powershell%2f&amp;title=Retrieve%20Azure%20Runbook%20Job%20Report%20using%20REST%20API%20with%20PowerShell" target="_blank" class="share-btn stumbleupon">
    <i class="fa fa-stumbleupon"></i>
    <p>StumbleUpon</p>
  </a>
</li>




<li>
  <a href="//www.pinterest.com/pin/create/button/?url=%2fblog%2fretrieve-azure-runbook-job-report-using-rest-api-with-powershell%2f&amp;description=Retrieve%20Azure%20Runbook%20Job%20Report%20using%20REST%20API%20with%20PowerShell" target="_blank" class="share-btn pinterest">
    <i class="fa fa-pinterest-p"></i>
    <p>Pinterest</p>
  </a>
</li>




<li>
  <a href="mailto:?subject=Check out this post by Chendrayan%20Venkatesan&amp;body=%2fblog%2fretrieve-azure-runbook-job-report-using-rest-api-with-powershell%2f" target="_blank" class="share-btn email">
    <i class="fa fa-envelope"></i>
    <p>Email</p>
  </a>
</li>


      </ul>
    </section>
  

  
    

    
        
        







  
  
    
  


        
        
        

        <a href="/blog/retrieve-azure-runbook-job-report-using-rest-api-with-powershell/" class="image featured">
            <img src="/img/2021/02/Feb-16-Report.jpg" alt="">
        </a>
    


  <div id="content">
    <h1 id="introduction">Introduction</h1>
<p>The tile may hit a question WHY? Because automation accounts and runbooks are almost outdated in 2021. Most prefer to use alternative solutions like Logic Apps, Function App Power Automate, or others. Hang On! Runbooks are still in use. Of late, I got a requirement to send a report on runbooks that got invoked in the last one hour.</p>
<blockquote>
<p>In PowerShell, it’s easy, as shown below</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">$Params = @{
    RunbookName           = <span style="color:#e6db74">&#39;MYRUNBOOKNAME&#39;</span>
    ResourceGroupName     = <span style="color:#e6db74">&#39;MYRESOURCEGROUPNAME&#39;</span>
    AutomationAccountName = <span style="color:#e6db74">&#39;MYAUTOMATIONACCOUNTNAME&#39;</span>
    StartTime             = $(Get-Date).AddHours(-1)
}
Get-AzAutomationJob @Params
</code></pre></div><p>In my case, the code needs to loop through 200 + subscriptions. Yes, that’s the reason I used REST API with PowerShell. By this approach, the code is befitting in the Azure Function app.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="color:#75715e">#region - Query</span>
$Query = <span style="color:#e6db74">&#34;Resources 
</span><span style="color:#e6db74">| where type =~ &#39;Microsoft.Automation/automationaccounts/runbooks&#39; and location =~ &#39;northeurope&#39; and name =~ &#39;{YOUR RUNBOOK NAME}&#39;
</span><span style="color:#e6db74">| project id, name , resourceGroup, subscriptionId, automationAccountName = tostring(split(id,&#39;/&#39;)[8])&#34;</span>
$PageSize = 1000
$Iteration = 0
$SearchParams = @{
    Query = $($Query)
    First = $PageSize
}
<span style="color:#66d9ef">[System.Collections.ArrayList]</span>$Runbooks = @()
<span style="color:#66d9ef">do</span> {
    $Iteration += 1
    $PageResults = Search-AzGraph @SearchParams -Verbose
    $SearchParams.Skip += $PageResults.Count
    $Runbooks.AddRange($PageResults)
} <span style="color:#66d9ef">while</span> ($PageResults.Count <span style="color:#f92672">-eq</span> $PageSize)
<span style="color:#75715e">#endregion</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="color:#75715e">#region - Generate Headers</span>
$azureRmProfile = <span style="color:#66d9ef">[Microsoft.Azure.Commands.Common.Authentication.Abstractions.AzureRmProfileProvider]</span>::Instance.Profile
$currentAzureContext = Get-AzContext
$profileClient = New-Object Microsoft.Azure.Commands.ResourceManager.Common.RMProfileClient($azureRmProfile)
$authorization = <span style="color:#e6db74">&#34;Bearer {0}&#34;</span> <span style="color:#f92672">-f</span> ($profileClient.AcquireAccessToken($currentAzureContext.Subscription.TenantId).AccessToken)
$Headers = @{Authorization = $authorization }
<span style="color:#75715e">#endregion</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="color:#75715e">#region - Fetch Last One Hour Job Status</span>
<span style="color:#66d9ef">[System.Collections.ArrayList]</span> $Results = @()
$Runbooks | . {
    <span style="color:#66d9ef">process</span> {
        $startTime = <span style="color:#66d9ef">[datetime]</span>::UtcNow.AddHours(-1).ToString(<span style="color:#e6db74">&#39;yyyy-MM-ddTHH:mm:ss.ffffffZ&#39;</span>)
        $Result = Invoke-RestMethod -Uri <span style="color:#e6db74">&#34;https://management.azure.com/subscriptions/</span>$($_.subscriptionId)<span style="color:#e6db74">/resourceGroups/</span>$($_.resourceGroup)<span style="color:#e6db74">/providers/Microsoft.Automation/automationAccounts/</span>$($_.automationAccountName)<span style="color:#e6db74">/jobs?</span><span style="color:#ae81ff">`$</span><span style="color:#e6db74">filter=properties/startTime ge </span>$($startTime)<span style="color:#e6db74"> and properties/runbook/name eq &#39;Start-PaaSComplianceCheck-Autofix&#39;&amp;api-version=2017-05-15-preview&#34;</span> -Headers $Headers
        $Results.AddRange($Result.value)
    }
}
$Collections = $Results | Select-Object @{Name = <span style="color:#e6db74">&#39;SubscriptionId&#39;</span>; Expression = { ($_.id -split <span style="color:#e6db74">&#39;/&#39;</span>)[2] } }, 
@{Name = <span style="color:#e6db74">&#39;ResourceGroupName&#39;</span>; Expression = { ($_.id -split <span style="color:#e6db74">&#39;/&#39;</span>)[4] } }, 
@{Name = <span style="color:#e6db74">&#39;AutomationAccountName&#39;</span>; Expression = { ($_.id -split <span style="color:#e6db74">&#39;/&#39;</span>)[8] } }, 
@{Name = <span style="color:#e6db74">&#39;LastModifiedTime&#39;</span>; Expression = { (<span style="color:#66d9ef">[datetime]</span>::Parse($_.properties.lastModifiedTime)) } },
@{Name = <span style="color:#e6db74">&#39;Status&#39;</span>; Expression = { ($_.properties.status) } } | Where-Object { $_.Status <span style="color:#f92672">-eq</span> <span style="color:#e6db74">&#39;Failed&#39;</span> }
<span style="color:#75715e">#endregion</span>
</code></pre></div><p>Hey, hang around with me – I would like to show a simple PSHTML trick to make your report super fancy in no time.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">$HtmlPart = html -Content {
        head -Content {
            style -Content $StyleSheet
        }

        body -content {
            hr 
            h4 -Content <span style="color:#e6db74">&#34;SOME TEXT&#34;</span>
            h5 -Content $(Get-Date)
            h5 -Content <span style="color:#e6db74">&#34;MEANINGFUL HEADERS&#34;</span>
            hr
            table -content {
                th -content <span style="color:#e6db74">&#39;SubscriptionId&#39;</span>
                th -content <span style="color:#e6db74">&#39;ResourceGroupName&#39;</span>
                th -content <span style="color:#e6db74">&#39;AutomationAccountName&#39;</span>
                th -content <span style="color:#e6db74">&#39;LastModifiedTime&#39;</span>
                th -content <span style="color:#e6db74">&#39;Status&#39;</span>
                <span style="color:#66d9ef">foreach</span> ($Collection <span style="color:#66d9ef">in</span> $Collections) {
                    tr -content {
                        td -content {
                            $Collection.SubscriptionId
                        }
                        td -content {
                            $Collection.ResourceGroupName
                        }
                        td -content {
                            $Collection.AutomationAccountName
                        }
                        td -content {
                            $Collection.LastModifiedTime
                        }
                        <span style="color:#66d9ef">if</span> ($Collection.Status <span style="color:#f92672">-ne</span> <span style="color:#e6db74">&#39;Completed&#39;</span>) {
                            td -content {
                                $Collection.Status
                            } -Style <span style="color:#e6db74">&#34;background-color:RED&#34;</span>
                        }
                        <span style="color:#66d9ef">else</span> {
                            td -content {
                                $Collection.Status
                            } -Style <span style="color:#e6db74">&#34;background-color:GREEN&#34;</span>
                        }
                    }
                }
            }   
        }
    }
</code></pre></div><blockquote>
<p>StyleSheet</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-css" data-lang="css"><span style="color:#f92672">body</span> {
    <span style="color:#66d9ef">background</span>: <span style="color:#66d9ef">white</span>;
    <span style="color:#66d9ef">font-family</span>: ShellLight;
}

<span style="color:#f92672">th</span> {
    <span style="color:#66d9ef">background</span>: <span style="color:#66d9ef">skyblue</span>;
    <span style="color:#66d9ef">color</span>: <span style="color:#66d9ef">black</span>;
}

<span style="color:#f92672">table</span> {
    <span style="color:#66d9ef">width</span>: <span style="color:#ae81ff">100</span><span style="color:#66d9ef">%</span>;
    <span style="color:#66d9ef">border</span>: <span style="color:#ae81ff">1</span>
}
</code></pre></div><p>That&rsquo;s for now! Let me connect with you sooner with another exciting topic.</p>

  </div>

  <footer>
    <ul class="stats">
  <li class="categories">
    <ul>
        
            
            
                <i class="fa fa-folder"></i>
                
                
                <li><a class="article-category-link" href="/categories/azure-automation-account">Azure Automation Account</a></li>
                
                
                <li><a class="article-category-link" href="/categories/azure-runbook-report">Azure RunBook Report</a></li>
                
            
        
    </ul>
  </li>
  <li class="tags">
    <ul>
        
            
            
                <i class="fa fa-tags"></i>
                
                
                <li><a class="article-category-link" href="/tags/resource-graph">Resource Graph</a></li>
                
                
                <li><a class="article-category-link" href="/tags/powershell">PowerShell</a></li>
                
                
                <li><a class="article-category-link" href="/tags/rest-api">REST API</a></li>
                
            
        
    </ul>
  </li>
</ul>

  </footer>

</article>

    <article class="post">
        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "shortname" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </article>


<ul class="actions pagination">
    
        <li><a href="/blog/collection-of-azure-resource-graph-query/"
                class="button big previous">Collection of Azure Resource Graph Query</a></li>
    

    
        <li><a href="/blog/using-pfx-in-azure-devops-to-generate-an-access-token-and-authenticate-powershell/"
                class="button big next">Using PFX in Azure DevOps to generate an access token and authenticate - PowerShell</a></li>
    
</ul>


    </div>
    
<section id="sidebar">

  
  <section id="intro">
    
    
      
        <a href='/'><img src="/img/main/ChenV.jpg" class="intro-circle" width="200" alt="Hugo Future Imperfect" /></a>
      
    
    
      <header>
        <h2>Chendrayan Venkatesan</h2>
        <p>Views are of my own</p>
      </header>
    
    
      <ul class="icons">
        
          
    <li><a href="/index.xml" type="application/rss+xml" target="_blank" title="RSS" class="fa fa-rss"></a></li>


        
        
  <li><a href="//github.com/chendrayanv" target="_blank" title="GitHub" class="fa fa-github"></a></li>

























  <li><a href="//linkedin.com/in/chendrayanv" target="_blank" title="LinkedIn" class="fa fa-linkedin"></a></li>







  <li><a href="//xing.com/profile/Chendrayan_Venkatesan" target="_blank" title="Xing" class="fa fa-xing"></a></li>





  <li><a href="//facebook.com/chendrayanv" target="_blank" title="Facebook" class="fa fa-facebook"></a></li>









  <li><a href="//youtube.com/https://www.youtube.com/channel/UC22S6qPibfs1xa3MIII0JNw" target="_blank" title="YouTube" class="fa fa-youtube"></a></li>





  <li><a href="//api.whatsapp.com/send?phone=%2b91%2096201%2078698" target="_blank" title="WhatsApp" class="fa fa-whatsapp"></a></li>













  <li><a href="//twitter.com/chendrayanv" target="_blank" title="Twitter" class="fa fa-twitter"></a></li>



  <li><a href="skype:chendrayan.venkatesan?userinfo" target="_blank" title="Skype" class="fa fa-skype"></a></li>







  <li><a href="//telegram.me/&#43;91%2096201%2078698" target="_blank" title="telegram" class="fa fa-telegram"></a></li>











  <li><a href="mailto:chendrayan.exchange@hotmail.com" title="Email" class="fa fa-envelope"></a></li>


      </ul>
    
  </section>

  
  <section class="recent-posts">
    <div class="mini-posts">
      <header>
        <h3>Recent Posts</h3>
      </header>
      <div class="posts-container">
        

        
          
        

        
          <article class="mini-post">
            <header>
              <h3>
                <a href="/blog/azure-event-grid-trigger-output-binding-to-table-storage-using-powershell/">Azure Event Grid Trigger Output Binding to Table Storage using PowerShell</a>
              </h3>
              
              <time class="published" datetime='2021-04-08'>
                April 8, 2021
              </time>
            </header>
            
    

    
        
        







  
  
    
  


        
        
        

        <a href="/blog/azure-event-grid-trigger-output-binding-to-table-storage-using-powershell/" class="image featured">
            <img src="/img/2021/04/Table-Storage.jpg" alt="">
        </a>
    


          </article>
        
          <article class="mini-post">
            <header>
              <h3>
                <a href="/blog/azure-functions-real-world-example-using-event-grid-trigger-with-powershell/">Azure Functions – Real-world example using Event Grid Trigger with PowerShell</a>
              </h3>
              
              <time class="published" datetime='2021-04-03'>
                April 3, 2021
              </time>
            </header>
            
    

    
        
        







  
  
    
  


        
        
        

        <a href="/blog/azure-functions-real-world-example-using-event-grid-trigger-with-powershell/" class="image featured">
            <img src="/img/2021/04/Blog-Az-Event-Grid.jpg" alt="">
        </a>
    


          </article>
        
          <article class="mini-post">
            <header>
              <h3>
                <a href="/blog/using-pfx-in-azure-devops-to-generate-an-access-token-and-authenticate-powershell/">Using PFX in Azure DevOps to generate an access token and authenticate - PowerShell</a>
              </h3>
              
              <time class="published" datetime='2021-03-18'>
                March 18, 2021
              </time>
            </header>
            
    

    
        
        







  
  
    
  


        
        
        

        <a href="/blog/using-pfx-in-azure-devops-to-generate-an-access-token-and-authenticate-powershell/" class="image featured">
            <img src="/img/2021/03/access_token_pfx_cert.jpg" alt="">
        </a>
    


          </article>
        
          <article class="mini-post">
            <header>
              <h3>
                <a href="/blog/retrieve-azure-runbook-job-report-using-rest-api-with-powershell/">Retrieve Azure Runbook Job Report using REST API with PowerShell</a>
              </h3>
              
              <time class="published" datetime='2021-02-16'>
                February 16, 2021
              </time>
            </header>
            
    

    
        
        







  
  
    
  


        
        
        

        <a href="/blog/retrieve-azure-runbook-job-report-using-rest-api-with-powershell/" class="image featured">
            <img src="/img/2021/02/Feb-16-Report.jpg" alt="">
        </a>
    


          </article>
        
          <article class="mini-post">
            <header>
              <h3>
                <a href="/blog/collection-of-azure-resource-graph-query/">Collection of Azure Resource Graph Query</a>
              </h3>
              
              <time class="published" datetime='2021-02-07'>
                February 7, 2021
              </time>
            </header>
            
    

    
        
        







  
  
    
  


        
        
        

        <a href="/blog/collection-of-azure-resource-graph-query/" class="image featured">
            <img src="/img/2021/02/ARG-PS-Collection.jpg" alt="">
        </a>
    


          </article>
        
      </div>

      
        <a href=
          
            /blog/
          
        class="button">View more posts</a>
      
    </div>
  </section>

  
  
  
  
  
    <section id="categories">
      <header>
        <h3>
          <a href="/categories/">Categories</a>
        </h3>
      </header>
        
          
        

        
        <p>
          <article>
            <header>
              
                <a href="/categories/azure/">azure</a>
                <span style="float:right;">10</span>
              
            </header>
          </article>
        </p>
        
        <p>
          <article>
            <header>
              
                <a href="/categories/azure-devops/">azure-devops</a>
                <span style="float:right;">5</span>
              
            </header>
          </article>
        </p>
        
        <p>
          <article>
            <header>
              
                <a href="/categories/powershell/">powershell</a>
                <span style="float:right;">3</span>
              
            </header>
          </article>
        </p>
        
        <p>
          <article>
            <header>
              
                <a href="/categories/azure-functions/">azure-functions</a>
                <span style="float:right;">2</span>
              
            </header>
          </article>
        </p>
        
        <p>
          <article>
            <header>
              
                <a href="/categories/arm/">arm</a>
                <span style="float:right;">1</span>
              
            </header>
          </article>
        </p>
        
        <p>
          <article>
            <header>
              
                <a href="/categories/azure-automation-account/">azure-automation-account</a>
                <span style="float:right;">1</span>
              
            </header>
          </article>
        </p>
        
        <p>
          <article>
            <header>
              
                <a href="/categories/azure-function/">azure-function</a>
                <span style="float:right;">1</span>
              
            </header>
          </article>
        </p>
        
        <p>
          <article>
            <header>
              
                <a href="/categories/azure-monitor/">azure-monitor</a>
                <span style="float:right;">1</span>
              
            </header>
          </article>
        </p>
        
        <p>
          <article>
            <header>
              
                <a href="/categories/azure-resource-graph/">azure-resource-graph</a>
                <span style="float:right;">1</span>
              
            </header>
          </article>
        </p>
        
        <p>
          <article>
            <header>
              
                <a href="/categories/azure-runbook-report/">azure-runbook-report</a>
                <span style="float:right;">1</span>
              
            </header>
          </article>
        </p>
        
        <p>
          <article>
            <header>
              
                <a href="/categories/azure-workbook/">azure-workbook</a>
                <span style="float:right;">1</span>
              
            </header>
          </article>
        </p>
        
        <p>
          <article>
            <header>
              
                <a href="/categories/client-assertion/">client-assertion</a>
                <span style="float:right;">1</span>
              
            </header>
          </article>
        </p>
        
        <p>
          <article>
            <header>
              
                <a href="/categories/event-grid-trigger/">event-grid-trigger</a>
                <span style="float:right;">1</span>
              
            </header>
          </article>
        </p>
        
        <p>
          <article>
            <header>
              
                <a href="/categories/jit/">jit</a>
                <span style="float:right;">1</span>
              
            </header>
          </article>
        </p>
        
        <p>
          <article>
            <header>
              
                <a href="/categories/project-bicep/">project-bicep</a>
                <span style="float:right;">1</span>
              
            </header>
          </article>
        </p>
        
        <p>
          <article>
            <header>
              
                <a href="/categories/pswriteword/">pswriteword</a>
                <span style="float:right;">1</span>
              
            </header>
          </article>
        </p>
        
    </section>
  
  

  
  
    <section id="mini-bio">
      <h3>About</h3>
      <p>Automation, Workflows, Integrations, Orchestrations, and Microsoft Technologies are his interests. His focus is to transform the organization model to achieve key business objectives such as enhanced customer focus, seamless end-to-end management, and integrated service capability</p>
      <a href="/about/" class="button">Learn More</a>
    </section>
  

  
  <section id="footer">
    
      <ul class="icons">
        
          
    <li><a href="/index.xml" type="application/rss+xml" target="_blank" title="RSS" class="fa fa-rss"></a></li>


        
        
  <li><a href="//github.com/chendrayanv" target="_blank" title="GitHub" class="fa fa-github"></a></li>

























  <li><a href="//linkedin.com/in/chendrayanv" target="_blank" title="LinkedIn" class="fa fa-linkedin"></a></li>







  <li><a href="//xing.com/profile/Chendrayan_Venkatesan" target="_blank" title="Xing" class="fa fa-xing"></a></li>





  <li><a href="//facebook.com/chendrayanv" target="_blank" title="Facebook" class="fa fa-facebook"></a></li>









  <li><a href="//youtube.com/https://www.youtube.com/channel/UC22S6qPibfs1xa3MIII0JNw" target="_blank" title="YouTube" class="fa fa-youtube"></a></li>





  <li><a href="//api.whatsapp.com/send?phone=%2b91%2096201%2078698" target="_blank" title="WhatsApp" class="fa fa-whatsapp"></a></li>













  <li><a href="//twitter.com/chendrayanv" target="_blank" title="Twitter" class="fa fa-twitter"></a></li>



  <li><a href="skype:chendrayan.venkatesan?userinfo" target="_blank" title="Skype" class="fa fa-skype"></a></li>







  <li><a href="//telegram.me/&#43;91%2096201%2078698" target="_blank" title="telegram" class="fa fa-telegram"></a></li>











  <li><a href="mailto:chendrayan.exchange@hotmail.com" title="Email" class="fa fa-envelope"></a></li>


      </ul>
    
    <p class="copyright">
      
        &copy; 2021
        
          iAutomate
        
      .
      Powered by <a href="//gohugo.io" target="_blank">Hugo</a>
    </p>
  </section>
</section>

    </div>
    <a id="back-to-top" href="#" class="fa fa-arrow-up fa-border fa-2x"></a>
    

    
      
    

    
      
      
      
        <script src="//cdn.bootcss.com/highlight.js/9.11.0/highlight.min.js"></script>
        
        
        
        <script src="//cdn.bootcss.com/highlight.js/9.11.0/languages/r.min.js"></script>
        <script src="//cdn.bootcss.com/highlight.js/9.11.0/languages/yaml.min.js"></script>
        <script src="//cdn.bootcss.com/highlight.js/9.11.0/languages/css.min.js"></script>
        <script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>
      
    
    
    
      <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/skel/3.0.1/skel.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.1.25/jquery.fancybox.min.js"></script>
      <script src="/js/util.js"></script>
      <script src="/js/main.js"></script>
      <script src="/js/backToTop.js"></script>
    

    
      
        
      
    

    
    <script>hljs.initHighlightingOnLoad();</script>
      <script src="//yihui.name/js/math-code.js"></script>
<script async
src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
</script>


  </body>
</html>

